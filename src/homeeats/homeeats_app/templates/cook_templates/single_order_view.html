{% extends 'cook_base.html' %}
{% load staticfiles %}

{% block title %}Home{% endblock %}
{% block pagecontent %}

<script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous">
</script>

<div class="container mt-2">
    <h2>Items in Order #{{order.id}}</h2>
    <ul class="list-group list-group-horizontal">
            {% for item in items  %}
        <div class="card justify-content-between m-2" style="width: 14rem;">
            <h5 class="card-header">{{item.dish.title}}</h5>
            <div class="card-body ">
                <h5 class="card-title">Quantity: {{item.quantity}}</h5>
            </div>
        </div>
        {% endfor %}
    </ul>
    <h2>Delivery Total: ${{order.total}}</h2>
    <div class="card justify-content-between m-2" style="width: 18rem;">
        <h5 class="card-header">{{user.first_name}} {{user.last_name}}</h5>
        <div class="card-body ">
            <p class="card-text">{{address.street_name}}</p>
            <p class="card-text">{{address.city}}, {{address.state}} {{address.zipcode}}</p>
            <p class="card-text font-weight-bold text-secondary">Phone: {{customer.phone_number}}</p>
        </div>
    </div>
    <!-- <span id="timer"><span id="minutes"></span>:<span id="seconds"></span></span> -->
</div>

<!-- <script>
    // let timezonefix = new Date("{{order.pending_deadline.isoformat}}");
    // let deadline = new Date(timezonefix.getTime() + 5*3600000);
    let deadline = new Date({{ order.pending_deadline|date:"U" }} * 1000);
    console.log("Deadline:",deadline);
    var interval = setInterval(function() { 
        let now = new Date(Date.now());
        let timeLeft = deadline-now;
        let minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60)); 
        let seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        if (seconds < 10){
            seconds = '0'+seconds;
        }
        document.getElementById("minutes").innerHTML = minutes;
        document.getElementById("seconds").innerHTML = seconds;
        if (timeLeft < 0) { 
            clearInterval(interval); 
            document.getElementById("timer").innerHTML = "EXPIRED";
            $.ajax({
                type: "POST",
                url: "{% url 'reject_order' %}",
                data: {
                'order_id': '{{order.id}}',
                'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    console.log("success");
                }
            });
        } 
    }, 1000);
</script> -->



        {% endblock %}